#!/usr/bin/env ruby

$running_jruby = defined?(JRUBY_VERSION) || (defined?(RUBY_ENGINE) && RUBY_ENGINE == 'jruby') || RUBY_PLATFORM == 'java'

if $running_jruby
  begin
    require 'spoon'
    require 'readline'
  rescue LoadError => e
    if e.message =~ /spoon/
      p "*** You must run 'gem install spoon' before using JimmyJukebox on JRuby ***"
      exit
    elsif e.message =~ /readline/
      p "*** You must install 'readline' to use JimmyJukebox on JRuby ***"
      exit
    else
      raise
    end
  end
else
  begin
    require 'readline'
    require 'posix/spawn'
  rescue LoadError => e
    if e.message =~ /readline/
      p "*** You must install 'readline' or the 'rb-readline' gem to use JimmyJukebox in Ruby ***"
      exit
    elsif e.message =~ /posix/ || e.message =~ /spawn/
      p "*** You must run 'gem install posix-spawn' before using JimmyJukebox in Ruby ***"
      exit
    else
      raise
    end
  end
end

lib = File.expand_path('../lib', File.dirname(__FILE__))
$LOAD_PATH.unshift(lib) if File.directory?(lib) && !$LOAD_PATH.include?(lib)
require 'jimmy_jukebox'
include JimmyJukebox

